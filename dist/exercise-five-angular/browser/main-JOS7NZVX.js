import{a as Pe,b as X,c as Re,d as ee,f as xe,h as ke}from"./chunk-RBSLF4J2.js";import{A as ce,Aa as Te,C as Y,D as d,E as f,F as de,G as g,H as p,I as a,J as n,K as m,L as ue,M as fe,O as j,Q as l,V as ge,W as he,X as ve,Z as M,a as D,aa as J,b as re,ba as be,c as _,ca as we,d as oe,da as Ee,e as b,ea as ye,f as ie,fa as Se,g as Z,ga as Ce,h as $,i as z,ia as Ie,j as y,ja as h,k as S,ka as L,l as w,m as ne,ma as k,n as se,o as P,oa as U,p as ae,pa as B,q as R,qa as V,r as C,ra as W,s as le,sa as Fe,t as x,ta as Q,u as me,ua as G,v as I,va as H,w as F,x as pe,xa as q,ya as Me,za as Ne}from"./chunk-K2BJVPF6.js";var K=(()=>{let e=class e{constructor(r){this.http=r,this.serverUrl="http://localhost:3000"}registerUser(r){return this.http.post(`${this.serverUrl}/users`,r)}getUserByEmail(r){return this.http.get(`${this.serverUrl}/users?email=${r}`)}};e.\u0275fac=function(o){return new(o||e)(x(be))},e.\u0275prov=R({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function ze(t,e){t&1&&(a(0,"small",13),l(1," Please enter email address! "),n())}function Ye(t,e){t&1&&(a(0,"small",13),l(1," Email address not well formed! "),n())}function Je(t,e){t&1&&(a(0,"small",14),l(1," Email and password do not match. Please try again. "),n())}var _e=(()=>{let e=class e{constructor(r,o){this.authService=r,this.router=o,this.wrongPassword=!1,this.loginForm=new Fe({email:new Q("",[B.required,B.email]),password:new Q("",[B.required])})}loginUser(){let{email:r,password:o}=this.loginForm.value;this.authService.getUserByEmail(r).subscribe(i=>{i.length>0&&i[0].password===o?(localStorage.setItem("email",r),this.router.navigate(["/blog"])):(this.wrongPassword=!0,setTimeout(()=>{this.wrongPassword=!1},3e3))})}};e.\u0275fac=function(o){return new(o||e)(f(K),f(h))},e.\u0275cmp=I({type:e,selectors:[["app-login"]],decls:24,vars:6,consts:[[1,"text-center"],[1,"container"],["novalidate","",3,"ngSubmit","formGroup"],[1,"form-group"],["for","exampleInputEmail1"],["type","email","formControlName","email","placeholder","Enter email",1,"form-control"],["class","form-text text-muted",4,"ngIf"],["for","exampleInputPassword1"],["type","password","formControlName","password","placeholder","Password",1,"form-control"],["class","form-text text-danger",4,"ngIf"],[2,"display","flex","justify-content","center"],["type","submit",1,"btn","btn-primary",3,"disabled"],[3,"routerLink"],[1,"form-text","text-muted"],[1,"form-text","text-danger"]],template:function(o,i){o&1&&(a(0,"h4",0),l(1,"Login Page"),n(),a(2,"div",1)(3,"form",2),j("ngSubmit",function(){return i.loginUser()}),a(4,"div",3)(5,"label",4),l(6,"Email address"),n(),m(7,"input",5),g(8,ze,2,0,"small",6)(9,Ye,2,0,"small",6),n(),m(10,"br"),a(11,"div",3)(12,"label",7),l(13,"Password"),n(),m(14,"input",8),n(),g(15,Je,2,0,"small",9),m(16,"br"),a(17,"div",10)(18,"button",11),l(19,"Log In"),n()(),a(20,"div",0),l(21," Not a member? "),a(22,"a",12),l(23,"Register"),n()()()()),o&2&&(d(3),p("formGroup",i.loginForm),d(5),p("ngIf",i.loginForm.controls.email.touched&&(i.loginForm.controls.email.errors==null?null:i.loginForm.controls.email.errors.required)),d(),p("ngIf",i.loginForm.controls.email.touched&&(i.loginForm.controls.email.errors==null?null:i.loginForm.controls.email.errors.email)),d(6),p("ngIf",i.wrongPassword),d(3),p("disabled",!i.loginForm.valid),d(4),p("routerLink","/register"))},dependencies:[M,L,G,U,V,W,H,q]});let t=e;return t})();var je=t=>{let e=t.get("password"),s=t.get("confirmPassword");return!e||!s||e.value===s.value?null:{passwordMismatch:!0}};function Qe(t,e){t&1&&(a(0,"small",19),l(1," Please enter email address! "),n())}function Xe(t,e){t&1&&(a(0,"small",19),l(1," Email address not well formed! "),n())}function et(t,e){t&1&&(a(0,"small",20),l(1," Password should match. "),n())}var Le=(()=>{let e=class e{constructor(r,o,i){this.fb=r,this.authService=o,this.router=i,this.registerForm=this.fb.group({name:[""],email:[""],bio:[""],password:[""],confirmPassword:[""]},{validators:je})}get name(){return this.registerForm.controls.name}get email(){return this.registerForm.controls.email}get bio(){return this.registerForm.controls.bio}get password(){return this.registerForm.controls.password}get confirmPassword(){return this.registerForm.controls.confirmPassword}onSubmit(){if(this.registerForm.valid){let r=D({},this.registerForm.value);delete r.confirmPassword,this.authService.registerUser(r).subscribe(o=>{console.log(o),this.router.navigate(["login"])},o=>console.log(o))}}};e.\u0275fac=function(o){return new(o||e)(f(Me),f(K),f(h))},e.\u0275cmp=I({type:e,selectors:[["app-register"]],decls:39,vars:6,consts:[[1,"text-center"],[1,"container"],["novalidate","",3,"ngSubmit","formGroup"],[1,"form-group"],["for","name"],["type","name","formControlName","name","placeholder","Enter your name",1,"form-control"],["for","exampleInputEmail1"],["type","email","formControlName","email","placeholder","Enter email",1,"form-control"],["class","form-text text-muted",4,"ngIf"],["for","bio"],["type","bio","formControlName","bio","placeholder","Tell something about yourself",1,"form-control"],["for","password"],["type","password","formControlName","password","placeholder","Enter password",1,"form-control"],["for","confirmPassword"],["type","password","formControlName","confirmPassword","placeholder","Enter password again",1,"form-control"],["class","errors?",4,"ngIf"],[2,"display","flex","justify-content","center"],["type","submit",1,"btn","btn-primary",3,"disabled"],[3,"routerLink"],[1,"form-text","text-muted"],[1,"errors?"]],template:function(o,i){o&1&&(a(0,"h4",0),l(1,"Login Page"),n(),a(2,"div",1)(3,"form",2),j("ngSubmit",function(){return i.onSubmit()}),a(4,"div",3)(5,"label",4),l(6,"Full Name"),n(),m(7,"input",5),n(),m(8,"br"),a(9,"div",3)(10,"label",6),l(11,"Email address"),n(),m(12,"input",7),g(13,Qe,2,0,"small",8)(14,Xe,2,0,"small",8),n(),m(15,"br"),a(16,"div",3)(17,"label",9),l(18,"Bio"),n(),m(19,"input",10),n(),m(20,"br"),a(21,"div",3)(22,"label",11),l(23,"Password"),n(),m(24,"input",12),n(),m(25,"br"),a(26,"div",3)(27,"label",13),l(28,"Confirm Password"),n(),m(29,"input",14),n(),g(30,et,2,0,"small",15),m(31,"br"),a(32,"div",16)(33,"button",17),l(34,"Register"),n()(),a(35,"div",0),l(36," Already a member? "),a(37,"a",18),l(38,"Log in"),n()()()()),o&2&&(d(3),p("formGroup",i.registerForm),d(10),p("ngIf",i.registerForm.controls.email.touched&&(i.registerForm.controls.email.errors==null?null:i.registerForm.controls.email.errors.required)),d(),p("ngIf",i.registerForm.controls.email.touched&&(i.registerForm.controls.email.errors==null?null:i.registerForm.controls.email.errors.email)),d(16),p("ngIf",(i.registerForm.errors==null?null:i.registerForm.errors.passwordMismatch)&&i.confirmPassword.valid&&i.password.valid),d(3),p("disabled",!i.registerForm.valid),d(4),p("routerLink","/login"))},dependencies:[M,L,G,U,V,W,H,q]});let t=e;return t})();var v=(t,e)=>localStorage.getItem("email")?!0:me(h).navigate(["login"]);var tt=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:_e},{path:"register",component:Le},{path:"blog",loadChildren:()=>import("./chunk-TH5HS6NT.js").then(t=>t.BlogModule),canActivate:[v]},{path:"book",loadChildren:()=>import("./chunk-VL56ABZQ.js").then(t=>t.BookModule),canActivate:[v]},{path:"profile",loadChildren:()=>import("./chunk-JF4ZH6RT.js").then(t=>t.UserModule),canActivate:[v]},{path:"blog/form",component:X,canActivate:[v]},{path:"blog/form/:id",component:X,canActivate:[v]},{path:"book/form",component:ee,canActivate:[v]},{path:"book/form/:id",component:ee,canActivate:[v]}],Ue=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=F({type:e}),e.\u0275inj=C({imports:[k.forRoot(tt),k]});let t=e;return t})();function rt(t,e){t&1&&(ue(0),m(1,"app-header"),fe())}var Be=(()=>{let e=class e{constructor(r){this.router=r,this.title="exercise-five-angular",this.showHeader=!0}ngOnInit(){this.router.events.subscribe(r=>{r instanceof Ce&&(this.showHeader=!["/login","/register","/"].includes(r.url))})}};e.\u0275fac=function(o){return new(o||e)(f(h))},e.\u0275cmp=I({type:e,selectors:[["app-root"]],decls:3,vars:1,consts:[[4,"ngIf"]],template:function(o,i){o&1&&(g(0,rt,2,0,"ng-container",0),m(1,"router-outlet")(2,"br")),o&2&&p("ngIf",i.showHeader)},dependencies:[M,Ie,xe]});let t=e;return t})();var A="Service workers are disabled or not supported by this browser";function ot(t){return Z(()=>oe(new Error(t)))}var T=class{constructor(e){if(this.serviceWorker=e,!e)this.worker=this.events=this.registration=ot(A);else{let r=$(e,"controllerchange").pipe(b(()=>e.controller)),o=Z(()=>_(e.controller)),i=ie(o,r);this.worker=i.pipe(S(E=>!!E)),this.registration=this.worker.pipe(P(()=>e.getRegistration()));let te=$(e,"message").pipe(b(E=>E.data)).pipe(S(E=>E&&E.type)).pipe(se());te.connect(),this.events=te}}postMessage(e,s){return this.worker.pipe(w(1),ae(r=>{r.postMessage(D({action:e},s))})).toPromise().then(()=>{})}postMessageWithOperation(e,s,r){let o=this.waitForOperationCompleted(r),i=this.postMessage(e,s);return Promise.all([i,o]).then(([,u])=>u)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(e){let s;return typeof e=="string"?s=r=>r.type===e:s=r=>e.includes(r.type),this.events.pipe(S(s))}nextEventOfType(e){return this.eventsOfType(e).pipe(w(1))}waitForOperationCompleted(e){return this.eventsOfType("OPERATION_COMPLETED").pipe(S(s=>s.nonce===e),w(1),b(s=>{if(s.result!==void 0)return s.result;throw new Error(s.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}},He=(()=>{let e=class e{get isEnabled(){return this.sw.isEnabled}constructor(r){if(this.sw=r,this.pushManager=null,this.subscriptionChanges=new re,!r.isEnabled){this.messages=y,this.notificationClicks=y,this.subscription=y;return}this.messages=this.sw.eventsOfType("PUSH").pipe(b(i=>i.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(b(i=>i.data)),this.pushManager=this.sw.registration.pipe(b(i=>i.pushManager));let o=this.pushManager.pipe(P(i=>i.getSubscription()));this.subscription=z(o,this.subscriptionChanges)}requestSubscription(r){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(A));let o={userVisibleOnly:!0},i=this.decodeBase64(r.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),u=new Uint8Array(new ArrayBuffer(i.length));for(let c=0;c<i.length;c++)u[c]=i.charCodeAt(c);return o.applicationServerKey=u,this.pushManager.pipe(P(c=>c.subscribe(o)),w(1)).toPromise().then(c=>(this.subscriptionChanges.next(c),c))}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(A));let r=o=>{if(o===null)throw new Error("Not subscribed to push notifications.");return o.unsubscribe().then(i=>{if(!i)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})};return this.subscription.pipe(w(1),P(r)).toPromise()}decodeBase64(r){return atob(r)}};e.\u0275fac=function(o){return new(o||e)(x(T))},e.\u0275prov=R({token:e,factory:e.\u0275fac});let t=e;return t})(),qe=(()=>{let e=class e{get isEnabled(){return this.sw.isEnabled}constructor(r){if(this.sw=r,!r.isEnabled){this.versionUpdates=y,this.unrecoverable=y;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(A));let r=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:r},r)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(A));let r=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:r},r)}};e.\u0275fac=function(o){return new(o||e)(x(T))},e.\u0275prov=R({token:e,factory:e.\u0275fac});let t=e;return t})();var Ve=new le("");function it(t,e,s,r){return()=>{if(!(J(r)&&"serviceWorker"in navigator&&s.enabled!==!1))return;navigator.serviceWorker.addEventListener("controllerchange",()=>{navigator.serviceWorker.controller!==null&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})});let o;if(typeof s.registrationStrategy=="function")o=s.registrationStrategy();else{let[u,...c]=(s.registrationStrategy||"registerWhenStable:30000").split(":");switch(u){case"registerImmediately":o=_(null);break;case"registerWithDelay":o=We(+c[0]||0);break;case"registerWhenStable":o=c[0]?z(Ge(t),We(+c[0])):Ge(t);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${s.registrationStrategy}`)}}t.get(de).runOutsideAngular(()=>o.pipe(w(1)).subscribe(()=>navigator.serviceWorker.register(e,{scope:s.scope}).catch(u=>console.error("Service worker registration failed with:",u))))}}function We(t){return _(null).pipe(ne(t))}function Ge(t){return t.get(he).isStable.pipe(S(s=>s))}function nt(t,e){return new T(J(e)&&t.enabled!==!1?navigator.serviceWorker:void 0)}var O=class{};function st(t,e={}){return pe([He,qe,{provide:Ve,useValue:t},{provide:O,useValue:e},{provide:T,useFactory:nt,deps:[O,Y]},{provide:ge,useFactory:it,deps:[ce,Ve,O,Y],multi:!0}])}var Ke=(()=>{let e=class e{static register(r,o={}){return{ngModule:e,providers:[st(r,o)]}}};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=F({type:e}),e.\u0275inj=C({providers:[He,qe]});let t=e;return t})();var Ze=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=F({type:e,bootstrap:[Be]}),e.\u0275inj=C({providers:[Se(),Pe,Re],imports:[ye,Ue,ke,we,Te,Ne,k,Ke.register("ngsw-worker.js",{enabled:!ve(),registrationStrategy:"registerWhenStable:30000"})]});let t=e;return t})();Ee().bootstrapModule(Ze).catch(t=>console.error(t));

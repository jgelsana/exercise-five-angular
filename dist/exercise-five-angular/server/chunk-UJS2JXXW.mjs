import './polyfills.server.mjs';
import{c as Ce}from"./chunk-KG55P6WV.mjs";import{a as xe,b as ee,c as Re,d as te,f as ke,h as Oe}from"./chunk-U7Z7SXSO.mjs";import{b as _,c as V,d as B,e as W,f as Me,g as X,h as G,i as H,k as q,l as Ne,m as Te,n as Pe}from"./chunk-MPG6ERUK.mjs";import{$ as p,$a as Fe,A as M,B as h,D as ce,I as de,Ia as N,Ma as Q,O as J,Qa as we,Sa as Ee,T as d,U as f,Xa as ye,Y as ue,Ya as Se,Za as Ie,_ as v,a as ie,ba as a,bb as b,c as j,ca as n,cb as U,d as oe,da as m,e as E,ea as fe,eb as k,f as ne,fa as ge,g as $,ha as L,i as z,j as Y,ja as l,k as I,l as F,m as y,n as se,o as ae,p as P,q as le,t as x,ta as he,u as g,ua as ve,v as me,w as R,x as pe,za as be}from"./chunk-VKRO4MSN.mjs";import{a as D}from"./chunk-VVCT4QZE.mjs";var K=(()=>{let e=class e{constructor(r){this.http=r,this.serverUrl="http://localhost:3000"}registerUser(r){return this.http.post(`${this.serverUrl}/users`,r)}getUserByEmail(r){return this.http.get(`${this.serverUrl}/users?email=${r}`)}};e.\u0275fac=function(i){return new(i||e)(R(we))},e.\u0275prov=x({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function ze(t,e){t&1&&(a(0,"small",13),l(1," Please enter email address! "),n())}function Ye(t,e){t&1&&(a(0,"small",13),l(1," Email address not well formed! "),n())}function Je(t,e){t&1&&(a(0,"small",14),l(1," Email and password do not match. Please try again. "),n())}var Le=(()=>{let e=class e{constructor(r,i){this.authService=r,this.router=i,this.wrongPassword=!1,this.loginForm=new Me({email:new X("",[V.required,V.email]),password:new X("",[V.required])})}loginUser(){let{email:r,password:i}=this.loginForm.value;this.authService.getUserByEmail(r).subscribe(o=>{o.length>0&&o[0].password===i?(localStorage.setItem("email",r),this.router.navigate(["/blog"])):(this.wrongPassword=!0,setTimeout(()=>{this.wrongPassword=!1},3e3))})}};e.\u0275fac=function(i){return new(i||e)(f(K),f(b))},e.\u0275cmp=M({type:e,selectors:[["app-login"]],decls:24,vars:6,consts:[[1,"text-center"],[1,"container"],["novalidate","",3,"ngSubmit","formGroup"],[1,"form-group"],["for","exampleInputEmail1"],["type","email","formControlName","email","placeholder","Enter email",1,"form-control"],["class","form-text text-muted",4,"ngIf"],["for","exampleInputPassword1"],["type","password","formControlName","password","placeholder","Password",1,"form-control"],["class","form-text text-danger",4,"ngIf"],[2,"display","flex","justify-content","center"],["type","submit",1,"btn","btn-primary",3,"disabled"],[3,"routerLink"],[1,"form-text","text-muted"],[1,"form-text","text-danger"]],template:function(i,o){i&1&&(a(0,"h4",0),l(1,"Login Page"),n(),a(2,"div",1)(3,"form",2),L("ngSubmit",function(){return o.loginUser()}),a(4,"div",3)(5,"label",4),l(6,"Email address"),n(),m(7,"input",5),v(8,ze,2,0,"small",6)(9,Ye,2,0,"small",6),n(),m(10,"br"),a(11,"div",3)(12,"label",7),l(13,"Password"),n(),m(14,"input",8),n(),v(15,Je,2,0,"small",9),m(16,"br"),a(17,"div",10)(18,"button",11),l(19,"Log In"),n()(),a(20,"div",0),l(21," Not a member? "),a(22,"a",12),l(23,"Register"),n()()()()),i&2&&(d(3),p("formGroup",o.loginForm),d(5),p("ngIf",o.loginForm.controls.email.touched&&(o.loginForm.controls.email.errors==null?null:o.loginForm.controls.email.errors.required)),d(),p("ngIf",o.loginForm.controls.email.touched&&(o.loginForm.controls.email.errors==null?null:o.loginForm.controls.email.errors.email)),d(6),p("ngIf",o.wrongPassword),d(3),p("disabled",!o.loginForm.valid),d(4),p("routerLink","/register"))},dependencies:[N,U,G,_,B,W,H,q]});let t=e;return t})();var Ue=t=>{let e=t.get("password"),s=t.get("confirmPassword");return!e||!s||e.value===s.value?null:{passwordMismatch:!0}};function Qe(t,e){t&1&&(a(0,"small",19),l(1," Please enter email address! "),n())}function Xe(t,e){t&1&&(a(0,"small",19),l(1," Email address not well formed! "),n())}function et(t,e){t&1&&(a(0,"small",20),l(1," Password should match. "),n())}var _e=(()=>{let e=class e{constructor(r,i,o){this.fb=r,this.authService=i,this.router=o,this.registerForm=this.fb.group({name:[""],email:[""],bio:[""],password:[""],confirmPassword:[""]},{validators:Ue})}get name(){return this.registerForm.controls.name}get email(){return this.registerForm.controls.email}get bio(){return this.registerForm.controls.bio}get password(){return this.registerForm.controls.password}get confirmPassword(){return this.registerForm.controls.confirmPassword}onSubmit(){if(this.registerForm.valid){let r=D({},this.registerForm.value);delete r.confirmPassword,this.authService.registerUser(r).subscribe(i=>{console.log(i),this.router.navigate(["login"])},i=>console.log(i))}}};e.\u0275fac=function(i){return new(i||e)(f(Ne),f(K),f(b))},e.\u0275cmp=M({type:e,selectors:[["app-register"]],decls:39,vars:6,consts:[[1,"text-center"],[1,"container"],["novalidate","",3,"ngSubmit","formGroup"],[1,"form-group"],["for","name"],["type","name","formControlName","name","placeholder","Enter your name",1,"form-control"],["for","exampleInputEmail1"],["type","email","formControlName","email","placeholder","Enter email",1,"form-control"],["class","form-text text-muted",4,"ngIf"],["for","bio"],["type","bio","formControlName","bio","placeholder","Tell something about yourself",1,"form-control"],["for","password"],["type","password","formControlName","password","placeholder","Enter password",1,"form-control"],["for","confirmPassword"],["type","password","formControlName","confirmPassword","placeholder","Enter password again",1,"form-control"],["class","errors?",4,"ngIf"],[2,"display","flex","justify-content","center"],["type","submit",1,"btn","btn-primary",3,"disabled"],[3,"routerLink"],[1,"form-text","text-muted"],[1,"errors?"]],template:function(i,o){i&1&&(a(0,"h4",0),l(1,"Login Page"),n(),a(2,"div",1)(3,"form",2),L("ngSubmit",function(){return o.onSubmit()}),a(4,"div",3)(5,"label",4),l(6,"Full Name"),n(),m(7,"input",5),n(),m(8,"br"),a(9,"div",3)(10,"label",6),l(11,"Email address"),n(),m(12,"input",7),v(13,Qe,2,0,"small",8)(14,Xe,2,0,"small",8),n(),m(15,"br"),a(16,"div",3)(17,"label",9),l(18,"Bio"),n(),m(19,"input",10),n(),m(20,"br"),a(21,"div",3)(22,"label",11),l(23,"Password"),n(),m(24,"input",12),n(),m(25,"br"),a(26,"div",3)(27,"label",13),l(28,"Confirm Password"),n(),m(29,"input",14),n(),v(30,et,2,0,"small",15),m(31,"br"),a(32,"div",16)(33,"button",17),l(34,"Register"),n()(),a(35,"div",0),l(36," Already a member? "),a(37,"a",18),l(38,"Log in"),n()()()()),i&2&&(d(3),p("formGroup",o.registerForm),d(10),p("ngIf",o.registerForm.controls.email.touched&&(o.registerForm.controls.email.errors==null?null:o.registerForm.controls.email.errors.required)),d(),p("ngIf",o.registerForm.controls.email.touched&&(o.registerForm.controls.email.errors==null?null:o.registerForm.controls.email.errors.email)),d(16),p("ngIf",(o.registerForm.errors==null?null:o.registerForm.errors.passwordMismatch)&&o.confirmPassword.valid&&o.password.valid),d(3),p("disabled",!o.registerForm.valid),d(4),p("routerLink","/login"))},dependencies:[N,U,G,_,B,W,H,q]});let t=e;return t})();var w=(t,e)=>localStorage.getItem("email")?!0:pe(b).navigate(["login"]);var tt=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:Le},{path:"register",component:_e},{path:"blog",loadChildren:()=>import("./chunk-NBJ2YZSH.mjs").then(t=>t.BlogModule),canActivate:[w]},{path:"book",loadChildren:()=>import("./chunk-T3TPQS5X.mjs").then(t=>t.BookModule),canActivate:[w]},{path:"profile",loadChildren:()=>import("./chunk-774TKXQF.mjs").then(t=>t.UserModule),canActivate:[w]},{path:"blog/form",component:ee,canActivate:[w]},{path:"blog/form/:id",component:ee,canActivate:[w]},{path:"book/form",component:te,canActivate:[w]},{path:"book/form/:id",component:te,canActivate:[w]}],Ve=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=h({type:e}),e.\u0275inj=g({imports:[k.forRoot(tt),k]});let t=e;return t})();function rt(t,e){t&1&&(fe(0),m(1,"app-header"),ge())}var Z=(()=>{let e=class e{constructor(r){this.router=r,this.title="exercise-five-angular",this.showHeader=!0}ngOnInit(){this.router.events.subscribe(r=>{r instanceof Ie&&(this.showHeader=!["/login","/register","/"].includes(r.url))})}};e.\u0275fac=function(i){return new(i||e)(f(b))},e.\u0275cmp=M({type:e,selectors:[["app-root"]],decls:3,vars:1,consts:[[4,"ngIf"]],template:function(i,o){i&1&&(v(0,rt,2,0,"ng-container",0),m(1,"router-outlet")(2,"br")),i&2&&p("ngIf",o.showHeader)},dependencies:[N,Fe,ke]});let t=e;return t})();var A="Service workers are disabled or not supported by this browser";function it(t){return $(()=>oe(new Error(t)))}var T=class{constructor(e){if(this.serviceWorker=e,!e)this.worker=this.events=this.registration=it(A);else{let r=z(e,"controllerchange").pipe(E(()=>e.controller)),i=$(()=>j(e.controller)),o=ne(i,r);this.worker=o.pipe(F(C=>!!C)),this.registration=this.worker.pipe(P(()=>e.getRegistration()));let re=z(e,"message").pipe(E(C=>C.data)).pipe(F(C=>C&&C.type)).pipe(ae());re.connect(),this.events=re}}postMessage(e,s){return this.worker.pipe(y(1),le(r=>{r.postMessage(D({action:e},s))})).toPromise().then(()=>{})}postMessageWithOperation(e,s,r){let i=this.waitForOperationCompleted(r),o=this.postMessage(e,s);return Promise.all([o,i]).then(([,u])=>u)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(e){let s;return typeof e=="string"?s=r=>r.type===e:s=r=>e.includes(r.type),this.events.pipe(F(s))}nextEventOfType(e){return this.eventsOfType(e).pipe(y(1))}waitForOperationCompleted(e){return this.eventsOfType("OPERATION_COMPLETED").pipe(F(s=>s.nonce===e),y(1),E(s=>{if(s.result!==void 0)return s.result;throw new Error(s.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}},He=(()=>{let e=class e{get isEnabled(){return this.sw.isEnabled}constructor(r){if(this.sw=r,this.pushManager=null,this.subscriptionChanges=new ie,!r.isEnabled){this.messages=I,this.notificationClicks=I,this.subscription=I;return}this.messages=this.sw.eventsOfType("PUSH").pipe(E(o=>o.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(E(o=>o.data)),this.pushManager=this.sw.registration.pipe(E(o=>o.pushManager));let i=this.pushManager.pipe(P(o=>o.getSubscription()));this.subscription=Y(i,this.subscriptionChanges)}requestSubscription(r){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(A));let i={userVisibleOnly:!0},o=this.decodeBase64(r.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),u=new Uint8Array(new ArrayBuffer(o.length));for(let c=0;c<o.length;c++)u[c]=o.charCodeAt(c);return i.applicationServerKey=u,this.pushManager.pipe(P(c=>c.subscribe(i)),y(1)).toPromise().then(c=>(this.subscriptionChanges.next(c),c))}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(A));let r=i=>{if(i===null)throw new Error("Not subscribed to push notifications.");return i.unsubscribe().then(o=>{if(!o)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})};return this.subscription.pipe(y(1),P(r)).toPromise()}decodeBase64(r){return atob(r)}};e.\u0275fac=function(i){return new(i||e)(R(T))},e.\u0275prov=x({token:e,factory:e.\u0275fac});let t=e;return t})(),qe=(()=>{let e=class e{get isEnabled(){return this.sw.isEnabled}constructor(r){if(this.sw=r,!r.isEnabled){this.versionUpdates=I,this.unrecoverable=I;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(A));let r=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:r},r)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(A));let r=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:r},r)}};e.\u0275fac=function(i){return new(i||e)(R(T))},e.\u0275prov=x({token:e,factory:e.\u0275fac});let t=e;return t})();var Be=new me("");function ot(t,e,s,r){return()=>{if(!(Q(r)&&"serviceWorker"in navigator&&s.enabled!==!1))return;navigator.serviceWorker.addEventListener("controllerchange",()=>{navigator.serviceWorker.controller!==null&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})});let i;if(typeof s.registrationStrategy=="function")i=s.registrationStrategy();else{let[u,...c]=(s.registrationStrategy||"registerWhenStable:30000").split(":");switch(u){case"registerImmediately":i=j(null);break;case"registerWithDelay":i=We(+c[0]||0);break;case"registerWhenStable":i=c[0]?Y(Ge(t),We(+c[0])):Ge(t);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${s.registrationStrategy}`)}}t.get(ue).runOutsideAngular(()=>i.pipe(y(1)).subscribe(()=>navigator.serviceWorker.register(e,{scope:s.scope}).catch(u=>console.error("Service worker registration failed with:",u))))}}function We(t){return j(null).pipe(se(t))}function Ge(t){return t.get(ve).isStable.pipe(F(s=>s))}function nt(t,e){return new T(Q(e)&&t.enabled!==!1?navigator.serviceWorker:void 0)}var O=class{};function st(t,e={}){return ce([He,qe,{provide:Be,useValue:t},{provide:O,useValue:e},{provide:T,useFactory:nt,deps:[O,J]},{provide:he,useFactory:ot,deps:[de,Be,O,J],multi:!0}])}var Ke=(()=>{let e=class e{static register(r,i={}){return{ngModule:e,providers:[st(r,i)]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=h({type:e}),e.\u0275inj=g({providers:[He,qe]});let t=e;return t})();var Ze=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=h({type:e,bootstrap:[Z]}),e.\u0275inj=g({providers:[Se(),xe,Re],imports:[ye,Ve,Oe,Ee,Pe,Te,k,Ke.register("ngsw-worker.js",{enabled:!be(),registrationStrategy:"registerWhenStable:30000"})]});let t=e;return t})();var at=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=h({type:e,bootstrap:[Z]}),e.\u0275inj=g({imports:[Ze,Ce]});let t=e;return t})();export{at as a};
